# 도커 네트워크 구성
외부에서 임의의 URL로 요청이 들어왔을 때, 지정한 로컬호스트 포트로 포트포워딩 되도록 Nginx에 사전 설정을 했습니다. 그리고 도커 컨테이너 실행 시 `docker run -p {호스트 포트번호}:{도커 포트번호}` 파라미터를 주어 특정 호스트 포트번호로 들어올 때 해당 도커 컨테이너의 포트번호로 전달되도록 했습니다.

- 궁금했던 점 1: 도커가 설치된 호스트 서버의 라우팅 테이블을 살펴봐도 도커 포트번호에 대한 명시가 없고, 단지 호스트 서버의 특정 포트로 들어온 요청은 도커 컨테이너 IP(172.17.xx.xx/16)로 넘기라는 명령만 있는데, 도커 컨테이너의 포트는 왜 필요하다는걸까? 도커 컨테이너 하나에도 vIP가 주어지고(CIDL 정책에 따라 도커 브릿지 네트워크와 같은 네트워크 ID를 공유) 그에 따라 16비트(0~65535)의 포트번호가 제공된다. 예를 들어 `-p 5000:5000`인 경우 특정 도커 컨테이너의 65535개의 포트 중에서 **5000번 포트**로 연결하라는 의미다. 즉 특정 어플리케이션이 특정 컨테이너 포트만을 사용하도록 사전에 설정되어 있을 때 필요하다. (예를 들어, 서버 어플리케이션 DockerFile에 `EXPOSE 9000` 이런 식으로 특정 포트를 개방하도록 명시) 지정된 컨테이너 포트에 호스트 포트를 연결해 주어야만 외부에서 접속할 수 있기 때문이다. 

- 궁금했던 점 2: 도커에 올라간 컨테이너는 어떻게 외부망과 연결되는지 작동 방식이 궁금했습니다. 도커(엔진)는 각 도커 컨테이너에 기존에 설정된 네트워크(도커 브릿지)의 CIDL 블록 범위 내에서 IP를 자동으로 할당합니다. 그리고 가상 L2 네트워크 인터페이스(eth0)를 제공합니다. 컨테이너가 생성되면서 동시에 도커 브릿지에 이 도커 컨테이너의 eth0와 1:1 바인딩되는 veth(virtual ethernet)가 만들어집니다. veth는 호스트 네트워크 인터페이스(eth0)와 연결되어 외부로부터 들어온 요청을 처리합니다.

- 궁금했던 점3: 넷마스크는 왜 필요한가? `255.255.255.0`의 정체는 도대체 뭐냐? 넷마스크와 IP주소와의 AND bit 연산을 통해 네트워크 주소를 알기 위함이다. 기본적으로 C클래스 IP를 모두 사용한다고 할 경우 2^8 - 2(네트워크 시작, 브로드캐스트 제외)(개)의 아이피를 사용할 수 있는데, 이 경우 넷마스크는 `255.255.255.0`이 된다. 

- 궁금했던 점4: 서브네팅이란?

